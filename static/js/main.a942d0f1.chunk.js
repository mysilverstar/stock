(this["webpackJsonpstock-manager"]=this["webpackJsonpstock-manager"]||[]).push([[0],{124:function(e,t,n){},128:function(e,t,n){},130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},135:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),i=n(14),o=n.n(i),r=n(25),s=(n(124),n(43)),l=n(24),d=n(96),u=n(17),b=n(58);n(137),n(126);b.a.initializeApp({apiKey:"AIzaSyDrC-Fz80eWezeDNlscZ_gB9QooILNuJ6k",authDomain:"kistone-stock.firebaseapp.com",projectId:"kistone-stock",storageBucket:"kistone-stock.appspot.com",messagingSenderId:"602515706055",appId:"1:602515706055:web:271be76a0fdc249f6eeee2",measurementId:"G-1CFXPBLJZE"});b.a.auth.Auth.Persistence.LOCAL;var j={google:{get:new b.a.auth.GoogleAuthProvider,id:"google.com"}},h=b.a.auth(),g=b.a.firestore(),p=(n(128),n(4));var m=function(e){var t=e.type,n={google:{background:"#ffffff",color:"#757575",title:"Sign in with Google",titleShort:"Google",icon:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg"},github:{background:"#333333",title:"Sign in with GitHub",titleShort:"GitHub",icon:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/github.svg"},facebook:{background:"#3b5998",title:"Sign in with Facebook",titleShort:"Facebook",icon:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/facebook.svg"}}[t],a=j[t];return Object(p.jsx)("div",{className:"signinButton",children:Object(p.jsxs)("button",{className:"firebaseui-idp-button mdl-button mdl-js-button mdl-button--raised firebaseui-id-idp-button","data-provider-id":a.id,style:{backgroundColor:n.background},"data-upgraded":",MaterialButton",onClick:function(){h.signInWithRedirect(a.get).then((function(e){})).catch((function(e){alert(e)}))},children:[Object(p.jsx)("span",{className:"firebaseui-idp-icon-wrapper",children:Object(p.jsx)("img",{className:"firebaseui-idp-icon",alt:"",src:n.icon})}),Object(p.jsx)("span",{className:"firebaseui-idp-text firebaseui-idp-text-long",style:{color:n.color},children:n.title})]})})};n(130);var O=Object(r.b)((function(e){return{store:e}}),null)((function(e){var t=e.history,n=e.store;return console.log("Login START"),Object(a.useEffect)((function(){n.authenticate.isAuth&&t.push("/main")}),[t,n.authenticate.isAuth]),Object(p.jsxs)("div",{className:"login_main",children:[Object(p.jsx)("div",{className:"title",children:"Stock Manager"}),Object(p.jsx)("div",{className:"button",children:Object(p.jsx)(m,{type:"google"})}),Object(p.jsx)("div",{className:"guest_button",onClick:function(){h.signInWithEmailAndPassword("guest@guest.com","password")},children:"Guest Login"})]})})),f=(n(131),n(82)),x=Object(f.b)({name:"ReduxStore",initialState:{authenticate:{user:void 0,isAuth:!1}},reducers:{login:function(e,t){return Object(s.a)(Object(s.a)({},e),{},{authenticate:t.payload})},logout:function(e,t){return Object(s.a)(Object(s.a)({},e),{},{authenticate:{user:void 0,isAuth:!1}})}}}),y=Object(f.a)({reducer:x.reducer}),v=x.actions,k=v.login,N=v.logout,S=y;n(132);var w=Object(r.b)((function(e){return{store:e}}),null)((function(e){var t=e.trading,n=e.store,c=e.handleItemSelect,i=Object(a.useState)([]),o=Object(l.a)(i,2),r=o[0],s=o[1],d=t.key,u=t.data,b=u.color,j=u.display,h=n.authenticate,m=function(e){c({target:e.currentTarget,tradingKey:d}),e.stopPropagation()};return Object(a.useEffect)((function(){return g.collection("user").doc(h.user).collection("trading").doc(d).collection("items").orderBy("indate","desc").onSnapshot((function(e){e.size>0?s(e.docs.map((function(e){return e.data()}))):g.collection("user").doc(h.user).collection("trading").doc(d).delete()}))}),[h,d]),Object(p.jsxs)("div",{className:"stocktable",children:[Object(p.jsx)("div",{className:"table_title",style:{color:b},children:Object(p.jsx)("strong",{children:j})}),Object(p.jsxs)("table",{children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{className:"stock_name",children:"\uc885\ubaa9\uba85"}),Object(p.jsx)("th",{className:"stock_price",children:"\ub2e8\uac00"}),Object(p.jsx)("th",{className:"stock_quantity",children:"\uc218\ub7c9"}),Object(p.jsx)("th",{className:"stock_indate",children:"\uc0c1\uc7a5\uc77c"})]})}),Object(p.jsx)("tbody",{children:r.map((function(e){var t=function(e){var t=new Date(e.indate);t.setHours(9,0,0,0);var n=((new Date).getTime()-t.getTime())/864e5,a={color:"dimgray"},c=0;return n>=0&&n<1?(a={color:"chartreuse"},c=1):n>=-2&&n<0?(a={color:"red"},c=2):n<-2&&(a={color:"darkgreen"}),{ddayState:c,changeStyle:a,displayDate:t.getMonth()+1+"/"+t.getDate()}}(e),n=t.ddayState,a=t.changeStyle,c=t.displayDate;return Object(p.jsxs)("tr",{onClick:m,children:[Object(p.jsx)("td",{className:"item_name",children:e.name}),Object(p.jsx)("td",{className:"item_price",children:String(e.price).replace(/\B(?=(\d{3})+(?!\d))/g,",")}),Object(p.jsx)("td",{className:"item_quantity",children:e.quantity}),Object(p.jsxs)("td",{className:"item_date",style:a,originaldate:new Date(e.indate),children:[Object(p.jsx)("span",{className:"main_text",children:c}),n>0&&Object(p.jsx)("span",{className:"sub_text",style:{color:"inherit"},children:1===n?"\uc785\uace0\uc644\ub8cc":"\uc785\uace0\uc608\uc815"})]})]},e.name)}))})]})]})})),C=n(97),A=n(164),I=n(167),E=n(178),D=n(176),T=n(181),B=n(180),_=n(172),L=n(173),M=n(22),R=n(175),F=[{key:"namuh",display:"\ub098\ubb34(NAMUH)",priority:0,color:"#00a383"},{key:"hankook",display:"\ud55c\uad6d\ud22c\uc790",priority:1,color:"#104e81"},{key:"mirae",display:"\ubbf8\ub798\uc5d0\uc14b",priority:2,color:"#e97f20"},{key:"kb",display:"KB\uc99d\uad8c",priority:3,color:"#f2b200"},{key:"shinhan",display:"\uc2e0\ud55c\uc54c\ud30c",priority:4,color:"#2e62da"},{key:"samsung",display:"\uc0bc\uc131\uc99d\uad8c",priority:5,color:"#14279b"}],z=Object(A.a)((function(e){return{paper:{boxSizing:"border-box",position:"absolute",width:"80%",maxWidth:"600px",backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5],padding:e.spacing(2,2,1),top:"50%",left:"50%",transform:"translate(-50%, -50%)"},selectEmpty:{marginTop:e.spacing(1),marginBottom:e.spacing(3)},formTrading:{minWidth:120},formInput:{width:"100%",marginBottom:"10px"}}}));var P=Object(r.b)((function(e){return{store:e}}),null)((function(e){var t=e.setOpen,n=e.store,c=e.selectedItem,i=e.handleItemSelect,o=0,r="",s="",d="",u=new Date;c&&(F.forEach((function(e,t){e.key===c.tradingKey&&(o=t)})),r=c.target.children[0].textContent,s=c.target.children[1].textContent.replace(",",""),d=c.target.children[2].textContent,u=new Date(c.target.children[3].getAttribute("originaldate")));var b=z(),j=Object(a.useState)(o),h=Object(l.a)(j,2),m=h[0],O=h[1],f=Object(a.useState)(r),x=Object(l.a)(f,2),y=x[0],v=x[1],k=Object(a.useState)(s),N=Object(l.a)(k,2),S=N[0],w=N[1],A=Object(a.useState)(d),P=Object(l.a)(A,2),q=P[0],G=P[1],K=Object(a.useState)(u),W=Object(l.a)(K,2),H=W[0],J=W[1],Q=n.authenticate,Z=null!==c;return Object(p.jsx)("div",{className:b.paper,children:Object(p.jsxs)("form",{children:[Object(p.jsxs)(I.a,{className:b.formTrading,children:[Object(p.jsx)(E.a,{id:"trading-select-label",children:"\uc99d\uad8c\uacc4\uc88c"}),Object(p.jsx)(D.a,{labelId:"trading-select-label",id:"trading-select",value:m,onChange:function(e){O(e.target.value)},className:b.selectEmpty,required:!0,disabled:Z,children:F.map((function(e,t){return Object(p.jsx)(T.a,{value:t,children:e.display},e.key)}))})]}),Object(p.jsxs)(I.a,{variant:"outlined",className:b.formInput,children:[Object(p.jsx)(E.a,{htmlFor:"name-input",children:"\uc885\ubaa9\uba85"}),Object(p.jsx)(B.a,{id:"name-input",value:y,onChange:function(e){v(e.target.value)},label:"Name",required:!0,disabled:Z})]}),Object(p.jsxs)(I.a,{variant:"outlined",className:b.formInput,children:[Object(p.jsx)(E.a,{htmlFor:"price-input",children:"\ub2e8\uac00"}),Object(p.jsx)(B.a,{id:"price-input",value:S,onChange:function(e){w(e.target.value)},label:"Price",type:"number"})]}),Object(p.jsxs)(I.a,{variant:"outlined",className:b.formInput,children:[Object(p.jsx)(E.a,{htmlFor:"quantity-input",children:"\uc218\ub7c9"}),Object(p.jsx)(B.a,{id:"quantity-input",value:q,onChange:function(e){G(e.target.value)},label:"Quantity",type:"number"})]}),Object(p.jsx)(M.a,{utils:C.a,children:Object(p.jsx)(R.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"date-picker-inline",label:"Month/Day/Year",value:H,onChange:function(e){J(e)},KeyboardButtonProps:{"aria-label":"change date"},PopoverProps:{anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"right"}},className:b.formInput})}),Object(p.jsxs)(_.a,{children:[Object(p.jsx)(L.a,{color:"primary",onClick:function(){return t(!1)},children:"\ucde8\uc18c"}),Object(p.jsx)(L.a,{color:"primary",onClick:function(e){if(e.preventDefault(),"guest@guest.com"===Q.user)return alert("please sign-in with private account"),t(!1),void i(null);var n=F[m],a=g.collection("user").doc(Q.user).collection("trading");a.doc(n.key).set({display:n.display,priority:n.priority,color:n.color}),a.doc(n.key).collection("items").doc(y).set({name:y,price:S,quantity:q,indate:H.valueOf()}).then((function(){})).catch((function(e){console.error("Error adding document: ",e)})),t(!1),i(null)},type:"submit",autoFocus:!0,children:c?"\uc218\uc815":"\ucd94\uac00"})]})]})})})),q=n(174),G=n(177),K=n(91),W=n.n(K),H=n(92),J=n.n(H),Q=n(93),Z=n.n(Q),U=n(94),X=n.n(U),Y=n(73),V=Object(A.a)((function(e){return{paper:{boxSizing:"border-box",position:"absolute",width:"80%",maxWidth:"600px",backgroundColor:e.palette.background.paper,borderRadius:"10px",boxShadow:e.shadows[5],padding:e.spacing(2,3,1),top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"black"}}}));var $=Object(r.b)((function(e){return{store:e}}),null)((function(e){var t=e.setOpen,n=e.store,a=e.selectedItem,c=e.handleItemSelect;a||t(!1);var i=null===a||void 0===a?void 0:a.target.children[0].innerText,o=V(),r=n.authenticate;return Object(p.jsxs)("div",{className:o.paper,children:[Object(p.jsx)("h3",{id:"simple-modal-title",children:"\uc0ad\uc81c"}),Object(p.jsx)("div",{style:{marginBottom:"20px"},children:"\uc0ad\uc81c \ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?"}),Object(p.jsxs)(_.a,{children:[Object(p.jsx)(L.a,{color:"primary",onClick:function(){return t(!1)},children:"\ucde8\uc18c"}),Object(p.jsx)(L.a,{color:"primary",onClick:function(){if("guest@guest.com"===r.user)return alert("please sign-in with private account"),t(!1),void c(null);g.collection("user").doc(r.user).collection("trading").doc(a.tradingKey).collection("items").doc(i).delete().then((function(){})).catch((function(e){console.error("Error removing document: ",e)})),t(!1),c(null)},type:"submit",autoFocus:!0,children:"\uc0ad\uc81c"})]})]})})),ee=Object(A.a)((function(e){return{fab:{},fabEdit:{color:e.palette.common.white,backgroundColor:Y.a[500],"&:hover":{backgroundColor:Y.a[600]}}}}));var te=Object(r.b)((function(e){return{store:e}}),(function(e){return{doLogout:function(){return e(N())}}}))((function(e){var t,n=e.history,c=e.store,i=e.doLogout,o=e.setLoading,r=c.authenticate,s=ee(),d=Object(a.useState)(!1),u=Object(l.a)(d,2),b=u[0],j=u[1],m=Object(a.useState)(!1),O=Object(l.a)(m,2),f=O[0],x=O[1],y=Object(a.useState)([]),v=Object(l.a)(y,2),k=v[0],N=v[1],S=Object(a.useState)(null),C=Object(l.a)(S,2),A=C[0],I=C[1];console.log("Main START"),Object(a.useEffect)((function(){return console.log("Main RENDERED"),r.isAuth?g.collection("user").doc(null===r||void 0===r?void 0:r.user).collection("trading").orderBy("priority","asc").onSnapshot((function(e){setTimeout((function(){o(!1)}),400),N(e.docs.map((function(e){return{key:e.id,data:e.data()}})))})):(console.log("Main goRoot!!"),void n.replace("/"))}),[r,n,o]);var E=function(){j(!0)},D=function(e){null===A||void 0===A||A.target.removeAttribute("class"),null===e||void 0===e||e.target.setAttribute("class","selected"),I(e)};return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("header",{children:Object(p.jsxs)("div",{className:"header_main",children:[Object(p.jsxs)("div",{className:"title",children:[Object(p.jsx)("span",{className:"main-title",children:"Stock Manager"}),Object(p.jsx)("span",{className:"sub-title",children:"@"+(null===(t=r.user)||void 0===t?void 0:t.split("@")[0])})]}),Object(p.jsxs)("div",{className:"logout",onClick:function(){h.signOut().then((function(){i(!1)}))},children:[Object(p.jsx)("span",{children:"Logout"}),Object(p.jsx)(W.a,{})]})]})}),Object(p.jsx)("div",{className:"main",onClick:function(){D(null)},children:k.map((function(e){return Object(p.jsx)(w,{trading:e,handleItemSelect:D},e.key)}))}),Object(p.jsx)("div",{className:A?"fab-area unselect fadeout":"fab-area unselect fadein",children:Object(p.jsx)(q.a,{className:s.fab,color:"primary","aria-label":"add",onClick:E,children:Object(p.jsx)(J.a,{})})}),Object(p.jsxs)("div",{className:A?"fab-area select slidein":"fab-area select slideout",children:[Object(p.jsx)(q.a,{className:s.fabEdit,color:"secondary","aria-label":"edit",onClick:E,children:Object(p.jsx)(Z.a,{})}),Object(p.jsx)(q.a,{className:s.fab,color:"secondary","aria-label":"delete",onClick:function(){x(!0)},children:Object(p.jsx)(X.a,{})})]}),Object(p.jsx)(G.a,{open:b,onClose:function(){j(!1)},"aria-labelledby":"add-stock","aria-describedby":"add-stock",children:Object(p.jsx)("div",{children:Object(p.jsx)(P,{setOpen:j,selectedItem:A,handleItemSelect:D})})}),Object(p.jsx)(G.a,{open:f,onClose:function(){x(!1)},"aria-labelledby":"add-stock","aria-describedby":"add-stock",children:Object(p.jsx)("div",{children:Object(p.jsx)($,{setOpen:x,selectedItem:A,handleItemSelect:D})})})]})})),ne=n(95),ae=n.n(ne);n(133);var ce=function(){return Object(p.jsx)("div",{className:"loading-area",children:Object(p.jsx)(ae.a,{type:"spinningBubbles",color:"gray",height:100,width:100})})};var ie=Object(r.b)((function(e){return{store:e}}),(function(e){return{doLogin:function(t){return e(k({user:t,isAuth:!0}))}}}))((function(e){var t=e.store,n=e.doLogin,c=t.authenticate,i=Object(a.useState)(!0),o=Object(l.a)(i,2),r=o[0],b=o[1];return console.log("App START"),Object(a.useEffect)((function(){return console.log("App RENDERED"),h.onAuthStateChanged((function(e){console.log("App onAuthStateChanged",e),e?n(e.email):setTimeout((function(){b(!1)}),500)}))}),[n]),Object(p.jsxs)(d.a,{children:[r&&Object(p.jsx)(ce,{}),Object(p.jsxs)(u.d,{children:[Object(p.jsx)(u.b,{exact:!0,path:"/",render:function(){return c.isAuth?Object(p.jsx)(u.a,{to:"/main"}):Object(p.jsx)(u.a,{to:"/login"})}}),Object(p.jsx)(u.b,{exact:!0,path:"/login",component:O}),Object(p.jsx)(u.b,{exact:!0,path:"/main",render:function(e){return Object(p.jsx)(te,Object(s.a)(Object(s.a)({},e),{},{setLoading:b}))}})]})]})}));o.a.render(Object(p.jsx)(r.a,{store:S,children:Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(ie,{})})}),document.getElementById("root"))}},[[135,1,2]]]);
//# sourceMappingURL=main.a942d0f1.chunk.js.map